trigger: 
- main

pool:
 vmImage: windows-latest

steps:
    - task: Docker@2
      inputs:
        command: 'build'
        Dockerfile: 'build/Dockerfile.build'
        buildContext: 'build'
        tags: 'my-build-tools'
    - task: Bash@3
      inputs:
        targetType: 'inline'
        script: |
          docker create -it --name build-tools -v $(System.DefaultWorkingDirectory):c:/code my-build-tools
          docker start build-tools
          docker exec build-tools msbuild C:\code\MySite.sln /p:OutputPath=c:\code\output
          docker stop build-tools
    - task: ArchiveFiles@2
      inputs:
        rootFolderOrFile: '$(System.DefaultWorkingDirectory)/output'
        includeRootFolder: false
        archiveType: 'zip'
        archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'
        replaceExistingArchive: true
    - task: PublishBuildArtifacts@1
      inputs:
        PathtoPublish: '$(Build.ArtifactStagingDirectory)'
        ArtifactName: 'drop'
        publishLocation: 'Container'